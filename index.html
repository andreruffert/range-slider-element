<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>range-slider-element</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
        font-size: 16px;
        display: flex;
        gap: 4em;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        min-height: 100vh;
        max-width: 500px;
        margin: 0 auto;
        padding: 1em;
      }

      main {
        display: flex;
        flex-direction: column;
        gap: 2em;
      }

      /* Example sections */
      section {
        display: flex;
        flex-direction: column;
      }

      section h1 {
        font-size: 1.2em;
      }

      /* Default example value output */
      section output {
        font-weight: 600;
        margin-bottom: 30px;
      }

      /* Custom styles examples */
      range-slider[data-style="example-1"] {
        outline: 0;

        [data-track] {
          background: linear-gradient(to right, #6221ea var(--value-percentage, 0%), #c6afe5 var(--value-percentage, 0%));
        }

        [data-thumb] {
          background: #6221ea;
          transition: transform 200ms ease;
          will-change: transform;
        }

        &:active [data-thumb] {
          box-shadow: none;
          transform: scale(1.5);
        }

        &:focus [data-thumb] {
          box-shadow: 0 0 0 0.3em rgba(98, 33, 234, 0.2);
        }
      }

      /* Value bubble example */
      range-slider:active .value-bubble {
        opacity: 1;
        transform: scale(1);
      }

      .value-bubble {
        --element-height: 24px;

        box-sizing: border-box;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="62" fill="none"><path fill="currentColor" d="M27.3 27.3C25 29.6 17 35.8 17 43v3c0 3 2.5 5 3.2 5.8a6 6 0 1 1-8.5 0C12.6 51 15 49 15 46v-3c0-7.2-8-13.4-10.3-15.7A16 16 0 0 1 16 0a16 16 0 0 1 11.3 27.3z"/><circle cx="16" cy="56" r="1" fill="%235D509E"/></svg>') top center no-repeat;
        position: absolute;
        bottom: calc(var(--element-height) / 2 - var(--thumb-size) / 2 - 2px);
        left: clamp(
          0%,
          calc(var(--value-percentage, 0%) + var(--thumb-size) / 2 * -1),
          calc(100% - var(--thumb-size))
        );
        margin-left: -8px;
        margin-block: auto;
        width: 32px;
        height: 62px;
        text-align: center;
        padding: 8px 3px 0;
        filter: drop-shadow(0 1px 3px rgba(0,0,0,0.3));
        transform-origin: 50% 90%;
        opacity: 0;
        transform: scale(.2);
        color: #fff;
        font: inherit;
        font-size: calc(100% - var(--value-width, 3) / 5 * .2em);
        text-overflow: clip;
        text-shadow: 0 -.5px 0 rgba(0,0,0,0.4);
        transition: all 200ms ease;
        transition-property: opacity, transform;
        will-change: transform;
        pointer-events: none;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <main>
      <h1>range-slider-element</h1>
      <section>
        <h1>default attributes</h1>
        <range-slider></range-slider>
      </section>

      <section>
        <h1>Negative attributes</h1>
        <range-slider min="-10" max="0"></range-slider>
      </section>

      <section>
        <h1>Floating point boundaries</h1>
        <range-slider min="10" max="11" step="0.1" value="10.2"></range-slider>
      </section>

      <section>
        <h1><code>value-precision="2"</code></h1>
        <range-slider min="0.20" max="1.200" step="0.10" value-precision="2"></range-slider>
      </section>

      <section>
        <h1><code>dir="rtl"</code></h1>
        <range-slider min="100" max="500" step="100" dir="rtl"></range-slider>
      </section>

      <section>
        <h1><code><code>orientation="vertical"</code></code></h1>
        <range-slider orientation="vertical"></range-slider>
      </section>

      <section>
        <h1><code>disabled</code></h1>
        <range-slider value="10" disabled></range-slider>
      </section>

      <section>
        <h1>Custom styling</h1>
        <range-slider data-style="example-1"></range-slider>
      </section>

      <section>
        <h1>Value bubble</h1>
        <range-slider data-style="example-1">
          <div data-track></div>
          <div data-thumb></div>
          <output class="value-bubble"></output>
        </range-slider>
      </section>

      <section>
        <h1>Form data support</h1>
        <form>
          <fieldset>
            <input type="range" name="native-input">
          </fieldset>
          <fieldset>
            <range-slider name="range-slider"></range-slider>
          </fieldset>
          <button type="submit">Submit</button>
          <pre class="form-data"></pre>
        </form>
      </section>

      <section>
        <h1><code>&lt;input type="range"&gt;</code></h1>
        <input type="range">
        <input type="range" style="writing-mode: vertical-lr; direction: rtl; width: 16px;">
      </section>
    </main>

    <script type="module" src="/src/index.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', setup);

      function setup() {
        const elements = document.querySelectorAll(['range-slider', 'input']);

        // Set initial output values
        elements.forEach(element => {
          element.insertAdjacentHTML('afterend', `
            <output>${element.value}</output>
          `);
        });

        // Update output values

        const updateOutputValue = (event) => {
          const rangeElement = event.target;
          const outputElement = rangeElement.nextElementSibling.closest('output');
          if (!outputElement) return;

          outputElement.textContent = rangeElement.value;
        };

        document.addEventListener('input', updateOutputValue);
        document.addEventListener('change', updateOutputValue);

        // Value bubble example
        const valueBubble = document.querySelector('.value-bubble');
        const valueBubbleRangeElement = valueBubble.closest('range-slider');
        valueBubble.textContent = valueBubbleRangeElement.value;
        document.addEventListener('input', event => {
          if (!valueBubbleRangeElement || !valueBubble) return;

          valueBubble.textContent = valueBubbleRangeElement.value;
          valueBubbleRangeElement.style.setProperty('--value-width', String(valueBubbleRangeElement.value).length);
        });

        // Form example
        document.querySelector('form').onsubmit = (event) => {
          event.preventDefault();

          if ('FormDataEvent' in window) {
            console.info('formdata event is supported')
          }

          if ('ElementInternals' in window && 'setFormValue' in window.ElementInternals.prototype) {
            console.info('Form-associated custom elements are supported')
          }

          const formData = new FormData(event.target);
          const formDataOutput = event.target.querySelector('.form-data');
          formDataOutput.textContent = JSON.stringify(Object.fromEntries(formData), null, 2);
        }
      }
    </script>
  </body>
</html>
